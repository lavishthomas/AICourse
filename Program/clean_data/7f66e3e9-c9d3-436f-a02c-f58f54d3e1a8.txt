The networks behind cryptocurrencies like bitcoin and Ethereum were built with mistrust in mind. After all, virtual currency users have every reason to believe that others on the network are trying to defraud them–claiming to send money when they haven’t done so, or trying to spend the same money multiple times.

Yet the safeguards that underly most cryptocurrency transactions have some real drawbacks. The system used to verify and permanently log transactions, for example, is slow and uses an enormous amount of power. (The bitcoin network consumes enough energy to power 1.5 million households, according to the Digiconomist Bitcoin Energy Consumption Index.) And while transferring funds on these networks is infamously anonymous, every transaction is still logged to a public ledger–which can make it possible to suss out who’s doing business with whom.

For a growing number of big companies interested in using blockchain technologies, these problems are a deal breaker. So it is perhaps fitting that the solution to this problem is coming from an old reliable in the technology business: Microsoft.

As part of an overall push into blockchain technology, the software giant has released easy-to-deploy blockchain services for Azure and is even collaborating with Bank of America to develop a blockchain-based method for managing trade finance. More recently, the company announced a new framework called Coco, which aims to help banks, insurers, and manufacturers establish shared, multi-company digital ledgers and automated smart contracts using blockchain software like Ethereum without sacrificing efficiency or confidentiality.

Coco relies on so-called trusted execution environments built into modern computing hardware and operating systems, like Virtual Secure Mode in Windows. These environments segregate data and code from other processes on a computer, so that it can’t be read or tampered with by other programs running on the machine. They’re often used for handling data encryption or software licensing management, where digital keys are deliberately kept secret.

When computers are communicating to form a blockchain, Coco creates trusted environments on each machine that certifies they are running the official, unaltered version of the network’s code. As a result, they skip many of the steps that slow down traditional blockchain networks, significantly boosting speed.

To show off the advantages, Microsoft took real transactions from the public Ethereum network and ran them through two in-house networks running two different versions of the Ethereum software. One set was run through an off-the-shelf cryptocurrency software, and the other was run through software adapted for use with Coco. The garden-variety software could execute about 10 to 20 transactions per second, with transactions sometimes taking close to a minute to process, while the Coco network could handle about 1,600 transactions in a second, according to Mark Russinovich, CTO of Microsoft Azure, the cloud computing platform.